from os import environ

import pytest
import requests


@pytest.fixture
def response():
    url = environ.get("URL")
    response = requests.get(url)
    return response.text


@pytest.fixture
def content():
    return """<html><head><meta name="referrer" content="strict-origin-when-cross-origin"><link href=\'/static/spreadsheets2/client/css/1644549501-v2-ritz_chart_css_ltr.css\' type=\'text/css\' rel=\'stylesheet\' nonce="0K9POrUGTPdjzQr4atCifw"></head><body style="padding:0;margin:0"><div id="embed_chart" style=\'width:468;height:285;overflow:hidden;\'></div><script type="text/javascript" nonce="0K9POrUGTPdjzQr4atCifw">var ritzspreadsheetconstants = {"localeName":"fr_CA","timeZoneConstants":{"GMT":{"names_ext":{"STD_GENERIC_LOCATION":"UTC","STD_LONG_NAME_GMT":"UTC"},"std_offset":0,"names":["UTC","heure moyenne de Greenwich"],"id":"GMT","transitions":[]},"Europe/Berlin":{"names_ext":{"DST_GENERIC_LOCATION":"heure : Allemagne","DST_LONG_NAME_GMT":"UTC+02:00","STD_GENERIC_LOCATION":"heure : Allemagne","STD_LONG_NAME_GMT":"UTC+01:00"},"std_offset":60,"names":["UTC+1","heure normale de l’Europe centrale","UTC+2","heure avancée de l’Europe centrale"],"id":"Europe/Berlin","transitions":[89953,60,94153,0,98521,60,102889,0,107257,60,111625,0,115993,60,120361,0,124729,60,129265,0,133633,60,138001,0,142369,60,146737,0,151105,60,155473,0,159841,60,164209,0,168577,60,172945,0,177313,60,181849,0,186217,60,190585,0,194953,60,199321,0,203689,60,208057,0,212425,60,216793,0,221161,60,225529,0,230065,60,235105,0,238801,60,243841,0,247537,60,252577,0,256273,60,261481,0,265009,60,270217,0,273745,60,278953,0,282649,60,287689,0,291385,60,296425,0,300121,60,305329,0,308857,60,314065,0,317593,60,322801,0,326329,60,331537,0,335233,60,340273,0,343969,60,349009,0,352705,60,357913,0,361441,60,366649,0,370177,60,375385,0,379081,60,384121,0,387817,60,392857,0,396553,60,401593,0,405289,60,410497,0,414025,60,419233,0,422761,60,427969,0,431665,60,436705,0,440401,60,445441,0,449137,60,454345,0,457873,60,463081,0,466609,60,471817,0,475513,60,480553,0,484249,60,489289,0,492985,60,498025,0,501721,60,506929,0,510457,60,515665,0,519193,60,524401,0,528097,60,533137,0,536833,60,541873,0,545569,60,550777,0,554305,60,559513,0,563041,60,568249,0,571777,60,576985,0,580681,60,585721,0,589417,60,594457,0]}},"numberFormatSymbols":{"DECIMAL_SEP":",","PERMILL":"‰","MINUS_SIGN":"-","PERCENT_PATTERN":"#,##0\xa0%","INFINITY":"∞","DEF_CURRENCY_CODE":"CAD","PLUS_SIGN":"+","CURRENCY_PATTERN":"#,##0.00\xa0¤","DECIMAL_PATTERN":"#,##0.###","SCIENTIFIC_PATTERN":"#E0","PERCENT":"%","EXP_SYMBOL":"E","GROUP_SEP":"\xa0","NAN":"NaN","ZERO_DIGIT":"0"},"allowTerminalDateSeparator":true,"amPmEnglishAccepted":false,"currencyPrefix":false,"currencyTag":"\\\\ [$$-C0C]","datePostsAreSuffix":true,"dateTimeWithoutYearPattern":"MMM d HH:mm","dateWithoutYearPattern":"MMM d","dayPost":"","decimalSeparator":",","defaultDatePattern":"yyyy-MM-dd","defaultDateTimePattern":"yyyy-MM-dd HH:mm:ss","defaultTimePattern":"HH:mm:ss","defaultUiLanguage":"fr_CA","exponentSeparator":"E","extraDateSeparator":"","firstDayOfWeek":0,"additionalFonts":[],"additionalFormats":[{"1":5,"2":"MMM d","3":1},{"1":7,"2":"MMM d HH:mm","3":1}],"amPmStrings":["a.m.","p.m."],"amString":"a.m.","monthsFull":["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],"monthsShort":["janv.","févr.","mars","avr.","mai","juin","juill.","août","sept.","oct.","nov.","déc."],"pmString":"p.m.","timePrefix":"","timeSeparator":":","weekdaysFull":["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"weekdaysShort":["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],"groupingSeparator":"\xa0","hourPost":"","minimalDaysInFirstWeek":1,"minusSign":"-","minutePost":"","monthPost":"","negativeParens":false,"percent":"%","periodIsDateSeparator":true,"plusSign":"+","secondPost":"","shortDateFormatSuffix":".","yearPost":"","textInputCurrencySymbol":"$"};</script><script type="text/javascript" nonce="0K9POrUGTPdjzQr4atCifw">var chartData = { };chartData[\'chart\'] = null;function initCharts() {chartData[\'chart\'] = {\'chartId\': \'chart\', \'elementId\': \'embed_chart\', \'chartJson\': \'\\x7b\\x22view\\x22:\\x7b\\x22columns\\x22:\\x5b0\\x5d\\x7d,\\x22dataTable\\x22:\\x7b\\x22parsedNumHeaders\\x22:1,\\x22rows\\x22:\\x5b\\x7b\\x22c\\x22:\\x5b\\x7b\\x22v\\x22:157277,\\x22f\\x22:\\x22157\xa0277\\x22\\x7d\\x5d\\x7d\\x5d,\\x22cols\\x22:\\x5b\\x7b\\x22pattern\\x22:\\x22#,##0\\x22,\\x22id\\x22:\\x22D\\x22,\\x22label\\x22:\\x22SUM de Nombre de participants \\/ Number of participants\\x22,\\x22type\\x22:\\x22number\\x22\\x7d\\x5d\\x7d,\\x22chartType\\x22:\\x22ScorecardChart\\x22,\\x22options\\x22:\\x7b\\x22applyAggregateData\\x22:0,\\x22curveType\\x22:\\x22function\\x22,\\x22backgroundColor\\x22:\\x7b\\x22fillOpacity\\x22:0,\\x22fill\\x22:\\x22#ffffff\\x22\\x7d,\\x22series\\x22:\\x7b\\x220\\x22:\\x7b\\x22aggregateFunction\\x22:\\x22sum\\x22\\x7d\\x7d,\\x22useFirstColumnAsDomain\\x22:false,\\x22width\\x22:468,\\x22title\\x22:\\x22Nombre de personnes ayant participé à une Fresque\\x22,\\x22titleTextStyle\\x22:\\x7b\\x22fontName\\x22:\\x22Arial\\x22,\\x22color\\x22:\\x22#434343\\x22,\\x22fontSize\\x22:16,\\x22bold\\x22:true,\\x22alignment\\x22:\\x22center\\x22\\x7d,\\x22scorecard\\x22:\\x7b\\x22number\\x22:\\x7b\\x22format\\x22:\\x7b\\x22source\\x22:\\x22custom\\x22\\x7d\\x7d,\\x22default\\x22:\\x7b\\x22comparison\\x22:\\x7b\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#000000\\x22,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d,\\x22key\\x22:\\x7b\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#202124\\x22,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d\\x7d,\\x22comparison\\x22:\\x7b\\x22percentage\\x22:false,\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#000000\\x22,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d,\\x22prefix\\x22:\\x22\\x22,\\x22scale\\x22:\\x7b\\x22factor\\x22:1\\x7d,\\x22postfix\\x22:\\x22\\x22,\\x22key\\x22:\\x7b\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#000000\\x22,\\x22bold\\x22:true,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d\\x7d,\\x22height\\x22:285\\x7d\\x7d\', \'serializedChartProperties\': \'\\x5bnull,\\x5b\\x221226531440\\x22\\x5d\\n,0,1,0,null,\\x5b\\x22\\x7b\\\\\\x22cols\\\\\\x22:\\x5b\\x7b\\\\\\x22id\\\\\\x22:\\\\\\x220\\\\\\x22,\\\\\\x22label\\\\\\x22:\\\\\\x22SUM de Nombre de participants \\/ Number of participants\\\\\\x22,\\\\\\x22type\\\\\\x22:\\\\\\x22number\\\\\\x22,\\\\\\x22pattern\\\\\\x22:\\\\\\x22#,##0\\\\\\x22\\x7d\\x5d,\\\\\\x22rows\\\\\\x22:\\x5b\\x7b\\\\\\x22c\\\\\\x22:\\x5b\\x7b\\\\\\x22v\\\\\\x22:157277.0,\\\\\\x22f\\\\\\x22:\\\\\\x22157\xa0277\\\\\\x22\\x7d\\x5d\\x7d\\x5d,\\\\\\x22parsedNumHeaders\\\\\\x22:1\\x7d\\x22,\\x220.6\\x22\\x5d\\n,0,null,\\x5bnull,null,22,\\x5bnull,\\x5b\\x5b\\x5bnull,null,1\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5b\\x22Nombre de personnes ayant participé à une Fresque\\x22,\\x5bnull,null,null,\\x22Arial\\x22,16,1,null,null,null,null,1,\\x5b-12369085\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,\\x5bnull,null,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,null,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,null,null,null,null,null,null,\\x5b16777215\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,\\x5b0\\x5d\\n,\\x5b\\x5b\\x5bnull,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5b\\x5b\\x22Horodatage\\x22\\x5d\\n,\\x5b\\x5d\\n,null,\\x5bnull,null,null,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,null,null,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,0,1,null,null,\\x5b\\x5b0,\\x5bnull,null,\\x5b\\x5d\\n,null,\\x5bnull,null,\\x5b\\x5d\\n\\x5d\\n,null,null,\\x5bnull,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n\\x5d\\n,null,null,null,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n,null,null,null,null,null,null,null,\\x5b\\x5b\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n,\\x5bnull,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,null,\\x5b\\x5d\\n,null,null,null,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,\\x5bnull,null,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,null,null,null,null,\\x5bnull,null,\\x5bnull,null,null,null,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,null,\\x5bnull,null,null,\\x5b\\x5b\\x5d\\n,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,null,\\x5bnull,null,null,\\x5bnull,null,null,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,null,null,\\x5b\\x5b\\x5bnull,\\x5bnull,null,null,null,-1,1,null,null,null,null,0,\\x5b-16777216\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5bnull,\\x5b-1979711488,null,null,null,-1,null,null,null,null,null,0\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b0,null,null,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,1,2,\\x5b\\x22\\x22,\\x22\\x22\\x5d\\n\\x5d\\n\\x5d\\n,null,null,null,null,\\x5b\\x5b\\x5b0,0\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n\', \'fallbackUri\': \'\\/spreadsheets\\/d\\/1qfmflHtLKB9G2QkEbfSfnttU-Feie2dc8fWJRZi8LyA\\/embed\\/oimg?newCharts\\x3dfalse\\x26oid\\x3d910418003\', \'chart\': null, \'interactionState\': ritz_tviz_charts.ChartsExportApi.newInteractionState()}; drawRitzChart( chartData[\'chart\'], \'fr_CA\',\'\\x7b\\x22enableHighPrecisionTrendLines\\x22:true,\\x22enableCustomizableSelectable\\x22:true,\\x22enableCustomizableM1\\x22:true,\\x22enableOverflowLegendHover\\x22:false,\\x22enableChartColorStyle\\x22:true,\\x22enableChartCustomizableLineShapeStyleable\\x22:true,\\x22enableChartWebFonts\\x22:false\\x7d\', 468.0 , 285.0 ,\'\\x5bnull,null,null,1\\x5d\\n\', true );}function drawRitzChart( chartState, spreadsheetLocale, serializedChartFlags, width, height, serializedWorkbookTheme, enableStandaloneCharts) {if (enableStandaloneCharts) {drawChartComponent(chartState, spreadsheetLocale, serializedChartFlags, width, height, serializedWorkbookTheme); return;}var canvas = document.createElement(\'canvas\'); var chartElement = document.getElementById(chartState.elementId); width = width == 0 ? window.innerWidth : width; height = height == 0 ? window.innerHeight : height; canvas.width = width; canvas.height = height; canvas.id = \'chart_\' + chartState.chartId; chartState.chart = ritz_tviz_charts.ChartsExportApi.buildAndLayoutChartFromGvizWrapper( canvas.getContext(\'2d\'), chartState.chartJson, width, height, spreadsheetLocale, serializedChartFlags); if (chartState.chart && ritz_tviz_charts.ChartsExportApi.renderChart( canvas.getContext(\'2d\'), chartState.chart, chartState.interactionState)) {canvas.addEventListener(\'click\', function(e) {handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale);}); canvas.addEventListener(\'mousemove\', function(e) {handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale);}); canvas.addEventListener(\'mouseleave\', function(e) {handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale);}); chartElement.appendChild(canvas);} else {var img = document.createElement(\'img\'); img.setAttribute(\'src\', chartState.fallbackUri); img.setAttribute(\'width\', width); img.setAttribute(\'height\', height); img.id = \'chart_\' + chartState.chartId; chartElement.appendChild(img);}chartState.tooltipRenderer = new docs.charts.Tooltip(new docs.zoom.Zoom(), chartElement);}function drawChartComponent(chartState, spreadsheetLocale, serializedChartFlags, width, height, serializedWorkbookTheme) {var chartElement = document.getElementById(chartState.elementId); width = width == 0 ? window.innerWidth : width; height = height == 0 ? window.innerHeight : height; chartState.chartComponent = new waffle.charts.export.RitzExportChartComponent( spreadsheetLocale, serializedChartFlags, new docs.zoom.Zoom()); chartState.chartComponent.render(chartElement); chartState.chartComponent.setSizeFromPrimitives(width, height); chartState.chartComponent.updateFromModel( ritz_tviz_charts.ChartsExportApi.createChartFromChartProperties( chartState.serializedChartProperties, serializedWorkbookTheme));}function layoutChart(chartState, canvas) {ritz_tviz_charts.ChartsExportApi.layoutChart( canvas.getContext(\'2d\'), chartState.chart, chartState.interactionState, canvas.width, canvas.height);}function renderChart(chartState, canvas) {ritz_tviz_charts.ChartsExportApi.renderChart( canvas.getContext(\'2d\'), chartState.chart, chartState.interactionState);}function handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale) {var x = e.clientX - canvas.getBoundingClientRect().left; var y = e.clientY - canvas.getBoundingClientRect().top; var oldState = chartState.interactionState; chartState.interactionState = (e.type == \'click\') ? ritz_tviz_charts.ChartsExportApi.onClick(chartState.chart, oldState, x, y) : ritz_tviz_charts.ChartsExportApi.onMouseMove(chartState.chart, oldState, x, y); if(ritz_tviz_charts.ChartsExportApi.isLayoutNeeded( chartState.chart, oldState, chartState.interactionState)) {layoutChart(chartState, canvas);}renderChart(chartState, canvas); if (chartState.tooltipRenderer) {if (e.type == \'mouseleave\') {chartState.tooltipRenderer.hide();} else {ritz_tviz_charts.ChartsExportApi.refreshTooltip( chartState.chart, chartState.tooltipRenderer, chartState.interactionState, serializedChartFlags, spreadsheetLocale);}}}function onChartsExportApiLoad() {initCharts();}function chartMessageFormat(str, args) {\n  return str.replace(/\\{\\{|\\}\\}|\\{(\\d+)\\}/g, function (m, n) {\n    if (m == "{{") { return "{"; }\n    if (m == "}}") { return "}"; }\n    return args[n];\n  });\n  }var __chartmessages = { };__chartmessages[\'CALL_CHART_REQUIRES_MINIMUM_COLUMNS\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Au moins \\x7b0\\x7d\xa0colonnes sont requises, mais seulement \\x7b1\\x7d ont été spécifiées.\', args);};__chartmessages[\'CALL_CHART_PIE_SLICE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Secteur \\x7b0\\x7d, \\x7b1\\x7d\xa0%.\', args);};__chartmessages[\'CALL_CHART_ORG_CHART_EDGE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Arête du parent \\x7b0\\x7d vers l\\x27enfant \\x7b1\\x7d.\', args);};__chartmessages[\'MSG_CHART_LEGEND_MORE\'] = \'Légende - suite\';__chartmessages[\'CALL_CHART_CHART_SUBTITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Sous-titre\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HISTOGRAM_COUNT\'] = \'(nombre)\';__chartmessages[\'CALL_CHART_ERROR_BARS\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Barres d\\x27erreur pour la série numéro\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_NO_DATA_DISPLAY\'] = \'Aucune donnée\';__chartmessages[\'CALL_CHART_PIE_SLICE_LABEL\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Libellé pour le secteur\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_STEPPED_LINE_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de lignes en escalier\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_ERROR_BAR_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Barre d\\x27erreur pour la série \\x7b0\\x7d, élément \\x7b1\\x7d\', args);};__chartmessages[\'CALL_CHART_TREE_MAP_MISSING_PARENT\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Impossible de trouver la ligne parente associée au libellé \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_POINT_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de points\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HISTOGRAM_INVALID_BUCKET_SIZE\'] = \'La taille des barres n\\x27est pas valide. Elle doit être supérieure à zéro.\';__chartmessages[\'MSG_CHART_TABLE_CHART_CONTENT\'] = \'Contenu du tableau\';__chartmessages[\'MSG_CHART_WATERFALL_CHART_TOTAL_UNLABELED\'] = \'Sous-total\';__chartmessages[\'CALL_CHART_WATERFALL_CHART_POSITIVE_LABELED\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Positives (\\x7b0\\x7d)\', args);};__chartmessages[\'CALL_CHART_LINE_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de courbes\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_CURVED_TREND_LINE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Courbe de tendance incurvée pour la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_CANDLESTICK_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de la série de bougies\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_TREE_MAP_MULTIPLE_ROOTS\'] = \'Deux\xa0nœuds racines ont été trouvés. Un seul est autorisé.\';__chartmessages[\'CALL_CHART_BAR_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de l\\x27histogramme\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_PIE_CHART\'] = \'Graphique à secteurs\';__chartmessages[\'CALL_CHART_RIGHT_VERTICAL_AXIS_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre de l\\x27axe vertical droit\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_ORG_CHART_CONTENT\'] = \'Contenu de l\\x27organigramme\';__chartmessages[\'MSG_CHART_GRID_CHART_CONTENT\'] = \'Contenu du graphique à bulles\';__chartmessages[\'MSG_CHART_GAUGE_CHART_CONTENT\'] = \'Contenu du graphique jauge\';__chartmessages[\'MSG_CHART_LEGEND\'] = \'Légende\';__chartmessages[\'CALL_CHART_EMPHASIZED_PIE_SLICE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Secteur \\x7b0\\x7d mis en valeur, \\x7b1\\x7d\xa0%.\', args);};__chartmessages[\'MSG_CHART_PIE_CHART_CONTENT\'] = \'Contenu du graphique à secteurs\';__chartmessages[\'CALL_CHART_GAUGE_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément de série de jauges\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_ANNOTATION_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Annotation pour l\\x27élément\xa0\\x7b1\\x7d de la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_POINT_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de la série de points\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_AREA_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Séries de zones\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_ORG_CHART_NODE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Nœud \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_COLUMN_MUST_BE_TEXT\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'La colonne \\x7b0\\x7d doit comporter du texte.\', args);};__chartmessages[\'CALL_CHART_TOTAL_DATA_LABEL_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b0\\x7d du libellé de données Total.\', args);};__chartmessages[\'MSG_CHART_RIGHT_VERTICAL_AXIS_TICK_MARKS\'] = \'Graduations à droite de l\\x27axe vertical\';__chartmessages[\'CALL_CHART_COLUMN_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de la série de colonnes\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HORIZONTAL_TICK_LABELS\'] = \'Libellés des graduations de l\\x27axe horizontal\';__chartmessages[\'CALL_CHART_LEGEND_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément de légende \\x7b0\\x7d\xa0: \\x7b1\\x7d\', args);};__chartmessages[\'CALL_CHART_COLUMN_MUST_BE_NUMERIC\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'La colonne \\x7b0\\x7d doit comporter des chiffres.\', args);};__chartmessages[\'CALL_CHART_HISTOGRAM_COUNT_LABEL\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'\\x7b0\\x7d (nombre)\', args);};__chartmessages[\'MSG_CHART_WATERFALL_CHART_POSITIVE_UNLABELED\'] = \'Positif\';__chartmessages[\'MSG_CHART_LOADING_DISPLAY\'] = \'Chargement…\';__chartmessages[\'CALL_CHART_LINEAR_TREND_LINE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Courbe de tendance linéaire pour la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HISTOGRAM_INVALID_BUCKET_PERCENTILE\'] = \'Le centile des barres n\\x27est pas valide. Il doit être compris entre 0 et 100\xa0%.\';__chartmessages[\'CALL_CHART_WATERFALL_CHART_TOTAL_LABELED\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Sous-total (\\x7b0\\x7d)\', args);};__chartmessages[\'CALL_CHART_COLUMN_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de colonnes\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_LEFT_VERTICAL_AXIS_TICK_MARKS\'] = \'Graduations à gauche de l\\x27axe vertical\';__chartmessages[\'CALL_CHART_CANDLESTICK_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de bougies\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_GEO_CHART_CONTENT\'] = \'Contenu de graphique géographique\';__chartmessages[\'MSG_CHART_INTERNAL_ERROR\'] = \'Une erreur interne s\\x27est produite lors de l\\x27affichage du graphique.\';__chartmessages[\'CALL_CHART_WATERFALL_CHART_NEGATIVE_LABELED\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Négatives (\\x7b0\\x7d)\', args);};__chartmessages[\'CALL_CHART_ANNOTATION_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Annotations pour la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_BOTTOM_HORIZONTAL_AXIS_TICK_MARKS\'] = \'Graduations sous l\\x27axe horizontal\';__chartmessages[\'MSG_CHART_WATERFALL_CHART_NEGATIVE_UNLABELED\'] = \'Négatives\';__chartmessages[\'CALL_CHART_STEPPED_AREA_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série d\\x27aires en escalier\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_BAR_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Histogramme\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_TREE_MAP_CHART_CONTENT\'] = \'Contenu du graphique de carte proportionnelle\';__chartmessages[\'MSG_CHART_VERTICAL_TICK_LABELS\'] = \'Graduations de l\\x27axe vertical\';__chartmessages[\'MSG_CHART_HORIZONTAL_MAJOR_GRIDLINES\'] = \'Quadrillage principal horizontal\';__chartmessages[\'CALL_CHART_CHART_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_LEGEND_MORE_ENTRIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'\\x7b0\\x7d\xa0autres\', args);};__chartmessages[\'CALL_CHART_LEFT_VERTICAL_AXIS_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre de l\\x27axe vertical gauche\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_TREE_MAP_DUPLICATE_NODE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Deux\xa0entrées sont associées au même libellé\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_SCORECARD_CHART_CONTENT\'] = \'Contenu du graphique de tableau de données\';__chartmessages[\'MSG_CHART_VERTICAL_MAJOR_GRIDLINES\'] = \'Quadrillage principal vertical\';__chartmessages[\'MSG_CHART_CHART_AREA\'] = \'Zone de graphique\';__chartmessages[\'CALL_CHART_HORIZONTAL_AXIS_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre de l\\x27axe horizontal\xa0: \\x7b0\\x7d\', args);};</script><script type="text/javascript" nonce="0K9POrUGTPdjzQr4atCifw">var CHARTS_EXPORT_URI = [];CHARTS_EXPORT_URI.push(\'\\/static\\/spreadsheets2\\/client\\/js\\/718683751-ChartsExportJ2cl_j2cl_core.js\');\n        if (window.addEventListener) {\n          window.addEventListener(\'load\',\n            function() {\n              window.tvizScriptLoader.load();\n            }\n          );\n        }\n        </script><script type="text/javascript" src=\'/static/spreadsheets2/client/js/778807247-ChartsCombinedJ2clBootstrap.js\' nonce="0K9POrUGTPdjzQr4atCifw"></script></body></html>"""


@pytest.fixture
def wrong_content():
    return """<html><head><meta name="referrer" content="strict-origin-when-cross-origin"><link href=\'/static/spreadsheets2/client/css/1644549501-v2-ritz_chart_css_ltr.css\' type=\'text/css\' rel=\'stylesheet\' nonce="0K9POrUGTPdjzQr4atCifw"></head><body style="padding:0;margin:0"><div id="embed_chart" style=\'width:468;height:285;overflow:hidden;\'></div><script type="text/javascript" nonce="0K9POrUGTPdjzQr4atCifw">var ritzspreadsheetconstants = {"localeName":"fr_CA","timeZoneConstants":{"GMT":{"names_ext":{"STD_GENERIC_LOCATION":"UTC","STD_LONG_NAME_GMT":"UTC"},"std_offset":0,"names":["UTC","heure moyenne de Greenwich"],"id":"GMT","transitions":[]},"Europe/Berlin":{"names_ext":{"DST_GENERIC_LOCATION":"heure : Allemagne","DST_LONG_NAME_GMT":"UTC+02:00","STD_GENERIC_LOCATION":"heure : Allemagne","STD_LONG_NAME_GMT":"UTC+01:00"},"std_offset":60,"names":["UTC+1","heure normale de l’Europe centrale","UTC+2","heure avancée de l’Europe centrale"],"id":"Europe/Berlin","transitions":[89953,60,94153,0,98521,60,102889,0,107257,60,111625,0,115993,60,120361,0,124729,60,129265,0,133633,60,138001,0,142369,60,146737,0,151105,60,155473,0,159841,60,164209,0,168577,60,172945,0,177313,60,181849,0,186217,60,190585,0,194953,60,199321,0,203689,60,208057,0,212425,60,216793,0,221161,60,225529,0,230065,60,235105,0,238801,60,243841,0,247537,60,252577,0,256273,60,261481,0,265009,60,270217,0,273745,60,278953,0,282649,60,287689,0,291385,60,296425,0,300121,60,305329,0,308857,60,314065,0,317593,60,322801,0,326329,60,331537,0,335233,60,340273,0,343969,60,349009,0,352705,60,357913,0,361441,60,366649,0,370177,60,375385,0,379081,60,384121,0,387817,60,392857,0,396553,60,401593,0,405289,60,410497,0,414025,60,419233,0,422761,60,427969,0,431665,60,436705,0,440401,60,445441,0,449137,60,454345,0,457873,60,463081,0,466609,60,471817,0,475513,60,480553,0,484249,60,489289,0,492985,60,498025,0,501721,60,506929,0,510457,60,515665,0,519193,60,524401,0,528097,60,533137,0,536833,60,541873,0,545569,60,550777,0,554305,60,559513,0,563041,60,568249,0,571777,60,576985,0,580681,60,585721,0,589417,60,594457,0]}},"numberFormatSymbols":{"DECIMAL_SEP":",","PERMILL":"‰","MINUS_SIGN":"-","PERCENT_PATTERN":"#,##0\xa0%","INFINITY":"∞","DEF_CURRENCY_CODE":"CAD","PLUS_SIGN":"+","CURRENCY_PATTERN":"#,##0.00\xa0¤","DECIMAL_PATTERN":"#,##0.###","SCIENTIFIC_PATTERN":"#E0","PERCENT":"%","EXP_SYMBOL":"E","GROUP_SEP":"\xa0","NAN":"NaN","ZERO_DIGIT":"0"},"allowTerminalDateSeparator":true,"amPmEnglishAccepted":false,"currencyPrefix":false,"currencyTag":"\\\\ [$$-C0C]","datePostsAreSuffix":true,"dateTimeWithoutYearPattern":"MMM d HH:mm","dateWithoutYearPattern":"MMM d","dayPost":"","decimalSeparator":",","defaultDatePattern":"yyyy-MM-dd","defaultDateTimePattern":"yyyy-MM-dd HH:mm:ss","defaultTimePattern":"HH:mm:ss","defaultUiLanguage":"fr_CA","exponentSeparator":"E","extraDateSeparator":"","firstDayOfWeek":0,"additionalFonts":[],"additionalFormats":[{"1":5,"2":"MMM d","3":1},{"1":7,"2":"MMM d HH:mm","3":1}],"amPmStrings":["a.m.","p.m."],"amString":"a.m.","monthsFull":["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],"monthsShort":["janv.","févr.","mars","avr.","mai","juin","juill.","août","sept.","oct.","nov.","déc."],"pmString":"p.m.","timePrefix":"","timeSeparator":":","weekdaysFull":["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"weekdaysShort":["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],"groupingSeparator":"\xa0","hourPost":"","minimalDaysInFirstWeek":1,"minusSign":"-","minutePost":"","monthPost":"","negativeParens":false,"percent":"%","periodIsDateSeparator":true,"plusSign":"+","secondPost":"","shortDateFormatSuffix":".","yearPost":"","textInputCurrencySymbol":"$"};</script><script type="text/javascript" nonce="0K9POrUGTPdjzQr4atCifw">var chartData = { };chartData[\'chart\'] = null;function initCharts() {chartData[\'chart\'] = {\'chartId\': \'chart\', \'elementId\': \'embed_chart\', \'chartJson\': \'\\x7b\\x22view\\x22:\\x7b\\x22columns\\x22:\\x5b0\\x5d\\x7d,\\x22dataTable\\x22:\\x7b\\x22parsedNumHeaders\\x22:1,\\x22rows\\x22:\\x5b\\x7b\\x22c\\x22:\\x5b\\x7b\\x22v\\x22:157277,\\x22f\\x22:\\x22157\xa0277\\x22\\x7d\\x5d\\x7d\\x5d,\\x22cols\\x22:\\x5b\\x7b\\x22pattern\\x22:\\x22#,##0\\x22,\\x22id\\x22:\\x22D\\x22,\\x22label\\x22:\\x22SUM de Nombre de participants \\/ Number of participants\\x22,\\x22type\\x22:\\x22number\\x22\\x7d\\x5d\\x7d,\\x22chartType\\x22:\\x22ScorecardChart\\x22,\\x22options\\x22:\\x7b\\x22applyAggregateData\\x22:0,\\x22curveType\\x22:\\x22function\\x22,\\x22backgroundColor\\x22:\\x7b\\x22fillOpacity\\x22:0,\\x22fill\\x22:\\x22#ffffff\\x22\\x7d,\\x22series\\x22:\\x7b\\x220\\x22:\\x7b\\x22aggregateFunction\\x22:\\x22sum\\x22\\x7d\\x7d,\\x22useFirstColumnAsDomain\\x22:false,\\x22width\\x22:468,\\x22title\\x22:\\x22Nombre de personnes ayant participé à une Fresque\\x22,\\x22titleTextStyle\\x22:\\x7b\\x22fontName\\x22:\\x22Arial\\x22,\\x22color\\x22:\\x22#434343\\x22,\\x22fontSize\\x22:16,\\x22bold\\x22:true,\\x22alignment\\x22:\\x22center\\x22\\x7d,\\x22scorecard\\x22:\\x7b\\x22number\\x22:\\x7b\\x22format\\x22:\\x7b\\x22source\\x22:\\x22custom\\x22\\x7d\\x7d,\\x22default\\x22:\\x7b\\x22comparison\\x22:\\x7b\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#000000\\x22,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d,\\x22key\\x22:\\x7b\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#202124\\x22,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d\\x7d,\\x22comparison\\x22:\\x7b\\x22percentage\\x22:false,\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#000000\\x22,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d,\\x22prefix\\x22:\\x22\\x22,\\x22scale\\x22:\\x7b\\x22factor\\x22:1\\x7d,\\x22postfix\\x22:\\x22\\x22,\\x22key\\x22:\\x7b\\x22textStyle\\x22:\\x7b\\x22color\\x22:\\x22#000000\\x22,\\x22bold\\x22:true,\\x22alignment\\x22:\\x22start\\x22\\x7d\\x7d\\x7d,\\x22height\\x22:285\\x7d\\x7d\', \'serializedChartProperties\': \'\\x5bnull,\\x5b\\x221226531440\\x22\\x5d\\n,0,1,0,null,\\x5b\\x22\\x7b\\\\\\x22cols\\\\\\x22:\\x5b\\x7b\\\\\\x22id\\\\\\x22:\\\\\\x220\\\\\\x22,\\\\\\x22label\\\\\\x22:\\\\\\x22SUM de Nombre de participants \\/ Number of participants\\\\\\x22,\\\\\\x22type\\\\\\x22:\\\\\\x22number\\\\\\x22,\\\\\\x22pattern\\\\\\x22:\\\\\\x22#,##0\\\\\\x22\\x7d\\x5d,\\\\\\x22rows\\\\\\x22:\\x5b\\x7b\\\\\\x22c\\\\\\x22:\\x5b\\x7b\\\\\\x22v\\\\\\x22:COUCOU.0,\\\\\\x22f\\\\\\x22:\\\\\\x22157\xa0277\\\\\\x22\\x7d\\x5d\\x7d\\x5d,\\\\\\x22parsedNumHeaders\\\\\\x22:1\\x7d\\x22,\\x220.6\\x22\\x5d\\n,0,null,\\x5bnull,null,22,\\x5bnull,\\x5b\\x5b\\x5bnull,null,1\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5b\\x22Nombre de personnes ayant participé à une Fresque\\x22,\\x5bnull,null,null,\\x22Arial\\x22,16,1,null,null,null,null,1,\\x5b-12369085\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,\\x5bnull,null,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,null,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n,null,null,null,null,null,null,\\x5b16777215\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,\\x5b0\\x5d\\n,\\x5b\\x5b\\x5bnull,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5b\\x5b\\x22Horodatage\\x22\\x5d\\n,\\x5b\\x5d\\n,null,\\x5bnull,null,null,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,null,null,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,0,1,null,null,\\x5b\\x5b0,\\x5bnull,null,\\x5b\\x5d\\n,null,\\x5bnull,null,\\x5b\\x5d\\n\\x5d\\n,null,null,\\x5bnull,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n\\x5d\\n,null,null,null,null,null,null,null,null,null,null,null,null,\\x5b\\x5d\\n,null,null,null,null,null,null,null,\\x5b\\x5b\\x5d\\n,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n,\\x5bnull,null,\\x5b\\x5d\\n\\x5d\\n,\\x5bnull,null,\\x5b\\x5d\\n,null,null,null,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,\\x5bnull,null,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,null,null,null,null,\\x5bnull,null,\\x5bnull,null,null,null,null,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,null,\\x5bnull,null,null,\\x5b\\x5b\\x5d\\n,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,null,\\x5bnull,null,null,\\x5bnull,null,null,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n\\x5d\\n,null,null,\\x5b\\x5b\\x5bnull,\\x5bnull,null,null,null,-1,1,null,null,null,null,0,\\x5b-16777216\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b\\x5bnull,\\x5b-1979711488,null,null,null,-1,null,null,null,null,null,0\\x5d\\n\\x5d\\n\\x5d\\n,\\x5b0,null,null,\\x5b\\x5d\\n,\\x5b\\x5d\\n\\x5d\\n,1,2,\\x5b\\x22\\x22,\\x22\\x22\\x5d\\n\\x5d\\n\\x5d\\n,null,null,null,null,\\x5b\\x5b\\x5b0,0\\x5d\\n\\x5d\\n\\x5d\\n\\x5d\\n\', \'fallbackUri\': \'\\/spreadsheets\\/d\\/1qfmflHtLKB9G2QkEbfSfnttU-Feie2dc8fWJRZi8LyA\\/embed\\/oimg?newCharts\\x3dfalse\\x26oid\\x3d910418003\', \'chart\': null, \'interactionState\': ritz_tviz_charts.ChartsExportApi.newInteractionState()}; drawRitzChart( chartData[\'chart\'], \'fr_CA\',\'\\x7b\\x22enableHighPrecisionTrendLines\\x22:true,\\x22enableCustomizableSelectable\\x22:true,\\x22enableCustomizableM1\\x22:true,\\x22enableOverflowLegendHover\\x22:false,\\x22enableChartColorStyle\\x22:true,\\x22enableChartCustomizableLineShapeStyleable\\x22:true,\\x22enableChartWebFonts\\x22:false\\x7d\', 468.0 , 285.0 ,\'\\x5bnull,null,null,1\\x5d\\n\', true );}function drawRitzChart( chartState, spreadsheetLocale, serializedChartFlags, width, height, serializedWorkbookTheme, enableStandaloneCharts) {if (enableStandaloneCharts) {drawChartComponent(chartState, spreadsheetLocale, serializedChartFlags, width, height, serializedWorkbookTheme); return;}var canvas = document.createElement(\'canvas\'); var chartElement = document.getElementById(chartState.elementId); width = width == 0 ? window.innerWidth : width; height = height == 0 ? window.innerHeight : height; canvas.width = width; canvas.height = height; canvas.id = \'chart_\' + chartState.chartId; chartState.chart = ritz_tviz_charts.ChartsExportApi.buildAndLayoutChartFromGvizWrapper( canvas.getContext(\'2d\'), chartState.chartJson, width, height, spreadsheetLocale, serializedChartFlags); if (chartState.chart && ritz_tviz_charts.ChartsExportApi.renderChart( canvas.getContext(\'2d\'), chartState.chart, chartState.interactionState)) {canvas.addEventListener(\'click\', function(e) {handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale);}); canvas.addEventListener(\'mousemove\', function(e) {handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale);}); canvas.addEventListener(\'mouseleave\', function(e) {handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale);}); chartElement.appendChild(canvas);} else {var img = document.createElement(\'img\'); img.setAttribute(\'src\', chartState.fallbackUri); img.setAttribute(\'width\', width); img.setAttribute(\'height\', height); img.id = \'chart_\' + chartState.chartId; chartElement.appendChild(img);}chartState.tooltipRenderer = new docs.charts.Tooltip(new docs.zoom.Zoom(), chartElement);}function drawChartComponent(chartState, spreadsheetLocale, serializedChartFlags, width, height, serializedWorkbookTheme) {var chartElement = document.getElementById(chartState.elementId); width = width == 0 ? window.innerWidth : width; height = height == 0 ? window.innerHeight : height; chartState.chartComponent = new waffle.charts.export.RitzExportChartComponent( spreadsheetLocale, serializedChartFlags, new docs.zoom.Zoom()); chartState.chartComponent.render(chartElement); chartState.chartComponent.setSizeFromPrimitives(width, height); chartState.chartComponent.updateFromModel( ritz_tviz_charts.ChartsExportApi.createChartFromChartProperties( chartState.serializedChartProperties, serializedWorkbookTheme));}function layoutChart(chartState, canvas) {ritz_tviz_charts.ChartsExportApi.layoutChart( canvas.getContext(\'2d\'), chartState.chart, chartState.interactionState, canvas.width, canvas.height);}function renderChart(chartState, canvas) {ritz_tviz_charts.ChartsExportApi.renderChart( canvas.getContext(\'2d\'), chartState.chart, chartState.interactionState);}function handleMouseEvent(e, canvas, chartState, serializedChartFlags, spreadsheetLocale) {var x = e.clientX - canvas.getBoundingClientRect().left; var y = e.clientY - canvas.getBoundingClientRect().top; var oldState = chartState.interactionState; chartState.interactionState = (e.type == \'click\') ? ritz_tviz_charts.ChartsExportApi.onClick(chartState.chart, oldState, x, y) : ritz_tviz_charts.ChartsExportApi.onMouseMove(chartState.chart, oldState, x, y); if(ritz_tviz_charts.ChartsExportApi.isLayoutNeeded( chartState.chart, oldState, chartState.interactionState)) {layoutChart(chartState, canvas);}renderChart(chartState, canvas); if (chartState.tooltipRenderer) {if (e.type == \'mouseleave\') {chartState.tooltipRenderer.hide();} else {ritz_tviz_charts.ChartsExportApi.refreshTooltip( chartState.chart, chartState.tooltipRenderer, chartState.interactionState, serializedChartFlags, spreadsheetLocale);}}}function onChartsExportApiLoad() {initCharts();}function chartMessageFormat(str, args) {\n  return str.replace(/\\{\\{|\\}\\}|\\{(\\d+)\\}/g, function (m, n) {\n    if (m == "{{") { return "{"; }\n    if (m == "}}") { return "}"; }\n    return args[n];\n  });\n  }var __chartmessages = { };__chartmessages[\'CALL_CHART_REQUIRES_MINIMUM_COLUMNS\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Au moins \\x7b0\\x7d\xa0colonnes sont requises, mais seulement \\x7b1\\x7d ont été spécifiées.\', args);};__chartmessages[\'CALL_CHART_PIE_SLICE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Secteur \\x7b0\\x7d, \\x7b1\\x7d\xa0%.\', args);};__chartmessages[\'CALL_CHART_ORG_CHART_EDGE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Arête du parent \\x7b0\\x7d vers l\\x27enfant \\x7b1\\x7d.\', args);};__chartmessages[\'MSG_CHART_LEGEND_MORE\'] = \'Légende - suite\';__chartmessages[\'CALL_CHART_CHART_SUBTITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Sous-titre\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HISTOGRAM_COUNT\'] = \'(nombre)\';__chartmessages[\'CALL_CHART_ERROR_BARS\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Barres d\\x27erreur pour la série numéro\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_NO_DATA_DISPLAY\'] = \'Aucune donnée\';__chartmessages[\'CALL_CHART_PIE_SLICE_LABEL\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Libellé pour le secteur\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_STEPPED_LINE_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de lignes en escalier\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_ERROR_BAR_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Barre d\\x27erreur pour la série \\x7b0\\x7d, élément \\x7b1\\x7d\', args);};__chartmessages[\'CALL_CHART_TREE_MAP_MISSING_PARENT\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Impossible de trouver la ligne parente associée au libellé \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_POINT_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de points\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HISTOGRAM_INVALID_BUCKET_SIZE\'] = \'La taille des barres n\\x27est pas valide. Elle doit être supérieure à zéro.\';__chartmessages[\'MSG_CHART_TABLE_CHART_CONTENT\'] = \'Contenu du tableau\';__chartmessages[\'MSG_CHART_WATERFALL_CHART_TOTAL_UNLABELED\'] = \'Sous-total\';__chartmessages[\'CALL_CHART_WATERFALL_CHART_POSITIVE_LABELED\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Positives (\\x7b0\\x7d)\', args);};__chartmessages[\'CALL_CHART_LINE_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de courbes\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_CURVED_TREND_LINE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Courbe de tendance incurvée pour la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_CANDLESTICK_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de la série de bougies\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_TREE_MAP_MULTIPLE_ROOTS\'] = \'Deux\xa0nœuds racines ont été trouvés. Un seul est autorisé.\';__chartmessages[\'CALL_CHART_BAR_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de l\\x27histogramme\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_PIE_CHART\'] = \'Graphique à secteurs\';__chartmessages[\'CALL_CHART_RIGHT_VERTICAL_AXIS_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre de l\\x27axe vertical droit\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_ORG_CHART_CONTENT\'] = \'Contenu de l\\x27organigramme\';__chartmessages[\'MSG_CHART_GRID_CHART_CONTENT\'] = \'Contenu du graphique à bulles\';__chartmessages[\'MSG_CHART_GAUGE_CHART_CONTENT\'] = \'Contenu du graphique jauge\';__chartmessages[\'MSG_CHART_LEGEND\'] = \'Légende\';__chartmessages[\'CALL_CHART_EMPHASIZED_PIE_SLICE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Secteur \\x7b0\\x7d mis en valeur, \\x7b1\\x7d\xa0%.\', args);};__chartmessages[\'MSG_CHART_PIE_CHART_CONTENT\'] = \'Contenu du graphique à secteurs\';__chartmessages[\'CALL_CHART_GAUGE_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément de série de jauges\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_ANNOTATION_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Annotation pour l\\x27élément\xa0\\x7b1\\x7d de la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_POINT_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de la série de points\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_AREA_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Séries de zones\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_ORG_CHART_NODE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Nœud \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_COLUMN_MUST_BE_TEXT\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'La colonne \\x7b0\\x7d doit comporter du texte.\', args);};__chartmessages[\'CALL_CHART_TOTAL_DATA_LABEL_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b0\\x7d du libellé de données Total.\', args);};__chartmessages[\'MSG_CHART_RIGHT_VERTICAL_AXIS_TICK_MARKS\'] = \'Graduations à droite de l\\x27axe vertical\';__chartmessages[\'CALL_CHART_COLUMN_SERIES_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément\xa0\\x7b1\\x7d de la série de colonnes\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HORIZONTAL_TICK_LABELS\'] = \'Libellés des graduations de l\\x27axe horizontal\';__chartmessages[\'CALL_CHART_LEGEND_ITEM\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Élément de légende \\x7b0\\x7d\xa0: \\x7b1\\x7d\', args);};__chartmessages[\'CALL_CHART_COLUMN_MUST_BE_NUMERIC\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'La colonne \\x7b0\\x7d doit comporter des chiffres.\', args);};__chartmessages[\'CALL_CHART_HISTOGRAM_COUNT_LABEL\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'\\x7b0\\x7d (nombre)\', args);};__chartmessages[\'MSG_CHART_WATERFALL_CHART_POSITIVE_UNLABELED\'] = \'Positif\';__chartmessages[\'MSG_CHART_LOADING_DISPLAY\'] = \'Chargement…\';__chartmessages[\'CALL_CHART_LINEAR_TREND_LINE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Courbe de tendance linéaire pour la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_HISTOGRAM_INVALID_BUCKET_PERCENTILE\'] = \'Le centile des barres n\\x27est pas valide. Il doit être compris entre 0 et 100\xa0%.\';__chartmessages[\'CALL_CHART_WATERFALL_CHART_TOTAL_LABELED\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Sous-total (\\x7b0\\x7d)\', args);};__chartmessages[\'CALL_CHART_COLUMN_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de colonnes\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_LEFT_VERTICAL_AXIS_TICK_MARKS\'] = \'Graduations à gauche de l\\x27axe vertical\';__chartmessages[\'CALL_CHART_CANDLESTICK_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série de bougies\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_GEO_CHART_CONTENT\'] = \'Contenu de graphique géographique\';__chartmessages[\'MSG_CHART_INTERNAL_ERROR\'] = \'Une erreur interne s\\x27est produite lors de l\\x27affichage du graphique.\';__chartmessages[\'CALL_CHART_WATERFALL_CHART_NEGATIVE_LABELED\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Négatives (\\x7b0\\x7d)\', args);};__chartmessages[\'CALL_CHART_ANNOTATION_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Annotations pour la série\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_BOTTOM_HORIZONTAL_AXIS_TICK_MARKS\'] = \'Graduations sous l\\x27axe horizontal\';__chartmessages[\'MSG_CHART_WATERFALL_CHART_NEGATIVE_UNLABELED\'] = \'Négatives\';__chartmessages[\'CALL_CHART_STEPPED_AREA_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Série d\\x27aires en escalier\xa0\\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_BAR_SERIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Histogramme\xa0\\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_TREE_MAP_CHART_CONTENT\'] = \'Contenu du graphique de carte proportionnelle\';__chartmessages[\'MSG_CHART_VERTICAL_TICK_LABELS\'] = \'Graduations de l\\x27axe vertical\';__chartmessages[\'MSG_CHART_HORIZONTAL_MAJOR_GRIDLINES\'] = \'Quadrillage principal horizontal\';__chartmessages[\'CALL_CHART_CHART_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_LEGEND_MORE_ENTRIES\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'\\x7b0\\x7d\xa0autres\', args);};__chartmessages[\'CALL_CHART_LEFT_VERTICAL_AXIS_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre de l\\x27axe vertical gauche\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'CALL_CHART_TREE_MAP_DUPLICATE_NODE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Deux\xa0entrées sont associées au même libellé\xa0: \\x7b0\\x7d\', args);};__chartmessages[\'MSG_CHART_SCORECARD_CHART_CONTENT\'] = \'Contenu du graphique de tableau de données\';__chartmessages[\'MSG_CHART_VERTICAL_MAJOR_GRIDLINES\'] = \'Quadrillage principal vertical\';__chartmessages[\'MSG_CHART_CHART_AREA\'] = \'Zone de graphique\';__chartmessages[\'CALL_CHART_HORIZONTAL_AXIS_TITLE\'] = function() {var args = []; for (i = 0; i < arguments.length; i++) {args[i] = arguments[i];}return chartMessageFormat(\'Titre de l\\x27axe horizontal\xa0: \\x7b0\\x7d\', args);};</script><script type="text/javascript" nonce="0K9POrUGTPdjzQr4atCifw">var CHARTS_EXPORT_URI = [];CHARTS_EXPORT_URI.push(\'\\/static\\/spreadsheets2\\/client\\/js\\/718683751-ChartsExportJ2cl_j2cl_core.js\');\n        if (window.addEventListener) {\n          window.addEventListener(\'load\',\n            function() {\n              window.tvizScriptLoader.load();\n            }\n          );\n        }\n        </script><script type="text/javascript" src=\'/static/spreadsheets2/client/js/778807247-ChartsCombinedJ2clBootstrap.js\' nonce="0K9POrUGTPdjzQr4atCifw"></script></body></html>"""
